function appendCheckboxes(e,t){var s=getStoredAssignments();e.forEach((e,a)=>{var n=e.pathname;e.parentNode.insertBefore(createCheckbox(n,t[a],s),e.nextSibling)})}function createCheckbox(e,t,s){var a=document.createElement("label");a.className="st-checkbox-container",a.innerHTML="&nbsp";var n=document.createElement("input");if(n.type="checkbox",n.className="st-checkbox",n.dataset.assignment=e,n.dataset.due=t,s&&s.data.length>0){const t=s.data.findIndex(t=>t.assignment===e);-1!==t&&(n.checked=s.data[t].isComplete,n.isChecked=s.data[t].isComplete)}n.addEventListener("click",function(){stOnAssignmentCheck(this.checked,this.dataset.assignment,this.dataset.due)});var o=document.createElement("span");return o.className="checkmark",a.appendChild(n),a.appendChild(o),a}function stOnAssignmentCheck(e,t,s){var a=getStoredAssignments();null===a&&(localStorage.setItem("st-assignments",JSON.stringify({data:[]})),a={data:[]});const n=a.data.findIndex(e=>e.assignment===t);-1===n?a.data.push({assignment:t,due:s,isComplete:e}):a.data[n].isComplete=e,localStorage.setItem("st-assignments",JSON.stringify(a))}function getStoredAssignments(){return JSON.parse(localStorage.getItem("st-assignments"))}function cleanLocalStorageAssignments(e){let t=getStoredAssignments();if(t&&t.data.length>0){let e=new Date;t.data.forEach((s,a)=>{parseInt(s.due)<parseInt(e.getTime()/1e3)&&t.data.splice(a,1)}),localStorage.setItem("st-assignments",JSON.stringify(t))}}async function themeManager(){setTheme(await getTheme());try{chrome.storage.onChanged.addListener(async function(e,t){("sync"===t||"local"===t&&"st-theme"in e)&&setTheme(e["st-theme"].newValue)})}catch(e){console.log(e)}}async function getTheme(){try{return new Promise((e,t)=>{chrome.storage.sync.get(["st-theme"],function(t){t["st-theme"]?e(t["st-theme"]):e("dark")})})}catch(e){console.log(e)}return"dark"}function setTheme(e){document.documentElement.setAttribute("data-st-theme",e),document.body.setAttribute("data-st-theme",e)}function createSidebarCollapse(e,t){let s=document.createElement("i"),a=getCollapseStates();if(a)if(a.data[t]){s.className="fas fa-chevron-right st-icon-collapse",s.setAttribute("data-is-collapsed",!0);let t=e.querySelector(".upcoming-list");t.classList.toggle("st-assignments-collapsed")}else s.className="fas fa-chevron-down st-icon-collapse",s.setAttribute("data-is-collapsed",!1);else s.className="fas fa-chevron-down st-icon-collapse",s.setAttribute("data-is-collapsed",!1);s.addEventListener("click",function(){handleCollapseToggle(this,t)}),e.insertBefore(s,e.firstChild)}function handleCollapseToggle(e,t){e.classList.toggle("fa-chevron-right"),e.classList.toggle("fa-chevron-down");let s=e.parentElement.querySelector(".upcoming-list");s.classList.toggle("st-assignments-collapsed"),e.setAttribute("data-is-collapsed","true"!==e.dataset.isCollapsed),saveCollapseState(t,"true"===e.dataset.isCollapsed)}function saveCollapseState(e,t){let s=getCollapseStates();s||(s={data:{upcoming:!1,overdue:!1}}),s.data[e]=t,localStorage.setItem("st-collapse",JSON.stringify(s))}function getCollapseStates(){return JSON.parse(localStorage.getItem("st-collapse"))}function displaySTLogo(){let e=document.createElement("div");e.className="st-overlay";let t=document.createElement("img");t.src=chrome.runtime.getURL("images/icon32.png"),t.className="st-logo";let s=document.createElement("div");s.className="st-logo-alert-wrapper";let a=document.createElement("div");a.className="st-logo-alert",a.innerHTML="You are running Schoology Tweaker!",s.append(a),e.append(t),e.append(s),document.body.append(e)}var upcoming=document.querySelector(".upcoming-events"),overdue=document.querySelector("#overdue-submissions");window.onload=async function(){themeManager(),displaySTLogo(),document.body.classList.contains("is-home")&&observer.observe(document,{childList:!0,subtree:!0})};var observer=new MutationObserver(function(e,t){if(upcoming){createSidebarCollapse(upcoming,"upcoming"),createSidebarCollapse(overdue,"overdue");let e=upcoming.querySelectorAll("a[href*=assignment]"),s=Array.from(upcoming.querySelectorAll(".upcoming-event")).map(e=>e.dataset.start);if(e)return document.body.classList.contains("is-home")&&cleanLocalStorageAssignments(e,s),appendCheckboxes(e,s),void t.disconnect()}else t.disconnect()});