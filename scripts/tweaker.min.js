function appendCheckboxes(e,t){var n=getStoredAssignments();e.forEach((e,s)=>{var a=e.pathname;e.parentNode.insertBefore(createCheckbox(a,t[s],n),e.nextSibling)})}function createCheckbox(e,t,n){var s=document.createElement("label");s.className="st-checkbox-container",s.innerHTML="&nbsp";var a=document.createElement("input");if(a.type="checkbox",a.className="st-checkbox",a.dataset.assignment=e,a.dataset.due=t,n&&n.data.length>0){const t=n.data.findIndex(t=>t.assignment===e);-1!==t&&(a.checked=n.data[t].isComplete,a.isChecked=n.data[t].isComplete)}a.addEventListener("click",function(){stOnAssignmentCheck(this.checked,this.dataset.assignment,this.dataset.due)});var c=document.createElement("span");return c.className="checkmark",s.appendChild(a),s.appendChild(c),s}function stOnAssignmentCheck(e,t,n){var s=getStoredAssignments();null===s&&(localStorage.setItem("st-assignments",JSON.stringify({data:[]})),s={data:[]});const a=s.data.findIndex(e=>e.assignment===t);-1===a?s.data.push({assignment:t,due:n,isComplete:e}):s.data[a].isComplete=e,localStorage.setItem("st-assignments",JSON.stringify(s))}function getStoredAssignments(){return JSON.parse(localStorage.getItem("st-assignments"))}function cleanLocalStorage(e){let t=getStoredAssignments();if(t&&t.data.length>0){let e=new Date;t.data.forEach((n,s)=>{parseInt(n.due)<parseInt(e.getTime()/1e3)&&t.data.splice(s,1)}),localStorage.setItem("st-assignments",JSON.stringify(t))}}async function themeManager(){setTheme(await getTheme());try{chrome.storage.onChanged.addListener(async function(e,t){("sync"===t||"local"===t&&"st-theme"in e)&&setTheme(e["st-theme"].newValue)})}catch(e){console.log(e)}}async function getTheme(){try{return new Promise((e,t)=>{chrome.storage.sync.get(["st-theme"],function(t){t["st-theme"]?e(t["st-theme"]):e("dark")})})}catch(e){console.log(e)}return"dark"}function setTheme(e){document.documentElement.setAttribute("data-st-theme",e),document.body.setAttribute("data-st-theme",e)}var upcoming=document.querySelector(".upcoming-events");window.onload=async function(){themeManager(),document.body.classList.contains("is-home")&&observer.observe(document,{childList:!0,subtree:!0})};var observer=new MutationObserver(function(e,t){if(upcoming){let e=upcoming.querySelectorAll("a[href*=assignment]"),n=Array.from(upcoming.querySelectorAll(".upcoming-event")).map(e=>e.dataset.start);if(e)return document.body.classList.contains("is-home")&&cleanLocalStorage(e,n),appendCheckboxes(e,n),void t.disconnect()}else t.disconnect()});